<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>CPU Util</title>

        <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/3.9.2/math.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
        <script src="https://wzrd.in/standalone/function-plot@1.14.0"></script>

        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
        <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

        <script src="cpu.js"></script>
        <link rel="stylesheet" href="cpu.css">




    </head>

    <body>


        <form id="form">
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                <input class="mdl-textfield__input" type="text" id="cpuUtil">
                <label class="mdl-textfield__label" for="cpuUtil">CPU Util (C)</label>
            </div>
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                <input class="mdl-textfield__input" type="text" id="processNumber">
                <label class="mdl-textfield__label" for="processNumber">Process Number (N)</label>
            </div>
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                <input class="mdl-textfield__input" type="text" id="iotime">
                <label class="mdl-textfield__label" for="iottime">IO Wait (P) </label>
            </div>




            <br />
            <button type="submit" class="mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect">
              Calculate
            </button>
        </form>

        <div id="plot"></div>

        <script>
            function calc() {
                console.log("Calculating!");
                cpuUtil(
                    $('#cpuUtil').val(),
                    $('#iotime').val(), $('#processNumber').val()
                );
                mdlCleanUp();

                console.log(`CPU = (1- ${$('#iotime').val()} ^ N)`);
                try {
                    functionPlot({
                        target: '#plot',
                        xDomain: [0, 10],
                        yDomain: [0, 1],
                        data: [{
                            fn: `y=(1- ${$('#iotime').val()} ^ x)`,
                            sampler: 'builtIn', // this will make function-plot use the evaluator of math.js
                            graphType: 'polyline'
                        }]
                    });
                } catch (err) {
                    console.log(err);
                    alert(err);
                }
            }
            //MDL Text Input Cleanup
            function mdlCleanUp(){
              var mdlInputs = document.querySelectorAll('.mdl-js-textfield');
              for (var i = 0, l = mdlInputs.length; i < l; i++) {
                mdlInputs[i].MaterialTextfield.checkDirty();
              }
            }

            document.getElementById('form').onsubmit = function(event) {
                event.preventDefault();
                calc();
            };
        </script>

    </body>

</html>
